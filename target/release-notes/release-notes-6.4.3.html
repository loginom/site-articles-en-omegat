<h1>Loginom 6.4.3 — Release Notes</h1>

<p>In this update, file storage was finalized, performance improvements related to operation of processor and memory in the multithreading mode were made, and some fixes were performed.</p>

<h2 id="исправление-ошибок">Fixes</h2>

<p><a href="https://help.loginom.ru/adminguide/server" target="_blank"><strong>Loginom Server:</strong></a>&nbsp;when several sessions with interconnected packages were completed simultaneously, the following error could occur: "Index value of Items parameter is out of range" that was recorded in the server log (#8470).</p>

<p><strong>Loginom Server:</strong>&nbsp;when using Apache web server with the configuration created by default, connection via Web Socket Proxy failed. The error was caused by the fact that&nbsp;<em>WS_PROXY_URI</em>&nbsp;parameter in the created &nbsp;<em>env.conf</em> file was set as&nbsp;<em>ws/</em>. The correct paramater value is&nbsp;<em>app/ws/</em>&nbsp;(#8544).</p>

<p><a href="https://help.loginom.ru/userguide/processors/integration/soap-request.html" target="_blank"><strong>SOAP request:</strong></a>&nbsp;if WSDL schema contained two items with the same names one of which was the root one, the following error occurred while request sending: "Input XSD schema does not comply with the node settings!" (#6179).</p>

<p><a href="https://help.loginom.ru/userguide/visualization/preview/quick-view.html" target="_blank"><strong>Quick view:</strong></a>&nbsp;in the Quick view detailing, values of the items with "Variable" type were displayed as&nbsp;(#8630).</p>

<p><a href="https://help.loginom.ru/userguide/processors/control/execute-node.html" target="_blank"><strong>Выполнение узла:</strong></a>&nbsp;если в настройках «Выполнения узла» в качестве выполняемого выбирался узел, для которого ранее порядок выполнения ранее был задан таким образом, что узел «Выполнения узла» должен выполниться раньше выбираемого узла, то возникала ошибка «Переход запрещен. Circular links between nodes are not allowed". The same error could occur while opening the package containing the same node configuration. Такая ситуация не является циклической зависимостью, так как при «Выполнении узла», в отличии от «Узла-ссылки», используется только конфигурация узла, а данные на вход могут подаваться отличные от тех, которые используются в базовом узле (#8614).</p>

<p><a href="https://help.loginom.ru/userguide/processors/transformation/trans-datatime/" target="_blank"><strong>Date and Time:</strong></a>&nbsp;when transforming dates to the string format, there were no leading zeros for year week, quarter week, year day and quarter day. The default month day format was with leading zero. The default Date and Time format was Fixed (<em>"2021-01-30"</em>,&nbsp;<em>"23:59:59"</em>,&nbsp;<em>"01:01:01"</em>) (#8595).</p>

<p><a href="https://help.loginom.ru/userguide/integration/import/warehouse.html" target="_blank"><strong>Импорт из Deductor Warehouse:</strong></a>&nbsp;если пакет с настроенным импортом из Deductor Warehouse сохранить и повторно открыть, то при попытке выполнить узел импорта возникала ошибка «Deductor Warehouse: Не указан объект Хранилища данных» (#8523).</p>

<p><strong>Импорт из Deductor Warehouse:</strong>&nbsp;если при проектировании в Процесс включили несколько раз одно и то же Измерение и изменили метку, то в мастера импорта в дереве параметров эти Измерения имели одинаковые названия, при этом после переноса таких Измерений в область Полей, их подписи отображалась корректно (#8556).</p>

<p><a href="https://help.loginom.ru/userguide/integration/connections/list/postgresql.html" target="_blank"><strong>Импорт из PostgreSQL:</strong></a>&nbsp;при использовании в запросе одного и того же параметра более одного раза возникала ошибка "Invalid parameters specified" (#8587).</p>

<p><a href="https://help.loginom.ru/userguide/visualization/binary-classification/" target="_blank"><strong>Качество бинарной классификации:</strong></a>&nbsp;при копировании в буфер обмена данных из матрицы ошибок к значениям в столбце&nbsp;<em>Классифицировано</em>&nbsp;добавлялся лишние символы&nbsp;<em>%</em>&nbsp;(#8638).</p>

<p><a href="https://help.loginom.ru/userguide/processors/preprocessing/fine-classes.html" target="_blank"><strong>Конечные классы:</strong></a>&nbsp;при переходе в мастере настройки назад со страницы настройки разбиения, а затем обратно, если изменялись настройки, влияющие на количество классов, то на страницах мастера продолжало отображаться предыдущее количество классов. Также это могло приводить к возникновении ошибок «Переход запрещен Невозможно использовать начальные классы в качестве разбиения для столбца ...&nbsp;Слишком много уникальных значений» или «Значение 0 параметра "Index" вне диапазона [-1; -1]» при переходе между страницами мастера настройки (#8282, #8582, #8584, #8668, #8700).</p>

<p><strong>Конечные классы:</strong>&nbsp;при объединении классов с непрерывным типом данных некорректно определялись верхние и нижние границы обновленных классов (#8577).</p>

<p><strong>Конечные классы:</strong>&nbsp;в режиме редактирования разбиения всегда были активны кнопки «Объединить с предыдущим» и «Объединить со следующим». Если после объединения классов, нажать на одну из кнопок, то происходило объединение классов, несмотря на то, что ни один из классов не был выделен. Теперь при включении редактирования явно отображается выделенный класс, а кнопки «Объединить с предыдущим» и «Объединить со следующим» становятся неактивными, если действие невозможно выполнить (#8578).</p>

<p><a href="https://help.loginom.ru/userguide/visualization/cube/" target="_blank"><strong>Куб:</strong></a>&nbsp;если после импорта из Deductor Warehouse или LGD-файла, в котором для полей были заданы назначения по умолчанию&nbsp;<em>Группа</em>, создавался визуализатор Куб и для полей с назначением по умолчанию&nbsp;<em>Группа</em>&nbsp;были настроены отображаемые факты, а затем добавлен вычисляемый факт на основе выбранных ранее для отображения фактов, после чего, скрывались факты, используемые при расчете вычисляемых фактов, то после сохранения и повторного открытия пакета вычисляемые факты не рассчитывались (#5803).</p>

<p><strong>Куб:</strong>&nbsp;при сохранении пакета не сохранялся порядок полей, перенесенных в область фильтрации Куба (#8490).</p>

<p><strong>Куб:</strong>&nbsp;если количество измерений в колонках было больше, чем количество колонок в кросс-таблице, то при экспорте часть меток измерений не отображалась. Такая ситуация могла возникнуть, если было отключено отображение итогов в колонках (#8639).</p>

<p><strong>Куб, <a href="https://help.loginom.ru/userguide/processors/control/submodel.html" target="_blank">Подмодель:</a></strong>&nbsp;если внутри базовой Подмодели у одного из узлов был настроен визуализатор Куб с настроенной сортировкой по одному из столбцов, то при попытке настроить производную Подмодель возникала ошибка "Атрибут __baseName не существует" (#8536).</p>

<p><strong>Куб, Подмодель:</strong>&nbsp;если внутри производной Подмодели у узла, содержащего настроенный визуализатор Куб настроить сортировку, а затем у узла базовой Подмодели добавить измерения в Кубе, то после обновления конфигурации узла настроенный визуализатор помечался ошибочным (#8528).</p>

<p><a href="https://help.loginom.ru/userguide/scenario/batchlauncher.html" target="_blank"><strong>Пакетное выполнение:</strong></a>&nbsp;если во время пакетного выполнения пакета, удалить или переименовать файл пакета, на который ссылается выполняемый пакет, то после выполнения основного пакета в лог сервера записывалось сообщение «Ошибка доступа к файлу: ...lgp», а выполненный пакет оставался в оперативной памяти сервера, а также удаленный или переименованный пакет продолжал отображаться в списке общих пакетов в Диспетчере (#8572).</p>

<p><strong><a href="https://help.loginom.ru/userguide/integration/connections/list/firebird.html" target="_blank">Подключения к БД FireBird,</a> <a href="https://help.loginom.ru/userguide/integration/connections/list/interbase.html" target="_blank">Interbase:</a></strong>&nbsp;после разрыва соединения с сервером базы данных не восстанавливалось соединение при повторной активации подключения (#8615).</p>

<p><strong>Подмодель:</strong>&nbsp;если был активирован узел, подключенный к выходному порту Подмодели, а сама Подмодель не была активирована, а после после этого пакет, содержащий Подмодель, был сохранен и закрыт, то при повторном открытии пакета и попытки активировать Подмодель, возникала ошибка «Порт не настроен» (#8538).</p>

<p><strong>Подмодель:</strong>&nbsp;если после создания производного компонента и создания производного узла, изменялась базовая Подмодель (например, внутрь подмодели был добавлен еще один узел), то при попытке активировать производный узел возникала ошибка «Внутренние узлы Подмодели заблокированы». The error occurred in version 6.4.2 (#8629).</p>

<p><a href="https://help.loginom.ru/userguide/visualization/table/" target="_blank"><strong>Таблица:</strong></a>&nbsp;в окне настройки фильтра в визуализаторе Таблица для полей типа&nbsp;<em>Дата/Время</em>&nbsp;при выборе условий&nbsp;<em>первый / не первый</em>&nbsp;или&nbsp;<em>последний / не последний</em>&nbsp;не определялось и не сохранялось значение параметра&nbsp;<em>Базовая дата интервала</em>&nbsp;(#8648).</p>

<p><a href="https://help.loginom.ru/userguide/processors/data-trees/table-to-tree.html" target="_blank"><strong>Таблица в дерево:</strong></a>&nbsp;если не получилось автоматически сопоставить входные и выходные поля, то после настройки узла возникала ошибка «Таблица в дерево: Выходному узлу ... не сопоставлен входной узел» и для исправления ошибки требовалось зайти в настройку выходного порта. Теперь, если при настройке узла возникает такая ситуация, открывается страница «Настройка соответствия между деревьями данных» (#8659).</p>

<p><a href="https://help.loginom.ru/userguide/processors/control/unit-link.html" target="_blank"><strong>Узел-ссылка:</strong></a>&nbsp;при сохранении пакета, содержащего Узел-ссылку, могла возникать ошибка «Узел "..." заблокирован», если в параллельной сессии выполнялся узел, использующий данные выходного порта исходного узла, на который был настроен Узел-ссылка (#8680).</p>

<p><a href="https://help.loginom.ru/userguide/location_user_files.html" target="_blank"><strong>Файловое хранилище:</strong></a>&nbsp;если новые каталоги стали доступны пользователю во время его текущей сессии, то при попытки перейти в такой каталог, пользователь получал ошибку "Cannot read property 'expandAsync' of undefined". Такая ситуация могла, например, возникнуть, если пользователю предоставлял доступ другой пользователь, были изменены права доступа к каталогам через панель Администрирование, или новый каталог был создан через диалог сохранения файла (#5347, #6032, #6423, #8022).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;если из каталога на уровень вверх или уровень вниз перемещался внутренний каталог, то при попытке открыть первый каталог возникала ошибка «System Error. Code: 3. System failed to find the specified path" (#6674).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;если после копирования каталога переименовать один из каталогов, содержащих копируемый каталог, то при вставке возникала ошибка «System Error. Code: 3. System failed to find the specified path" (#7082).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;если загрузить, а затем удалить файл, то невозможно было повторно загрузить с таким же именем до завершения сессии приложения. The error occurred in the browsers based on Chromium, in Internet Explorer and Safari (#7108, #8058, #8499).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;при переходе из текущего каталога в родительский, выделение устанавливалось на&nbsp;<em>".."</em>, а не на каталог, из которого вышли. Из-за неправильной установки фокуса мог некорректно работать функционал копирования–вставки через горячие клавиши (#8023, #8516).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;при попытке открыть пакет через символическую ссылку на файл, физически расположенный в сетевой папке, из-за невозможности определить дату модификации файла, возникала ошибка «Системе не удается найти указанный путь» (#8452).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;из дерева каталогов не удалялась удаленная через «Вырезать–Вставить» папка. При попытке перейти на нее в дереве каталогов возникала ошибка «System Error. Code: 3. System failed to find the specified path" (#8518).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;если&nbsp;перейти в папку файлового хранилища, ранее открытую в другой вкладке, а затем попытаться закрыть вкладку с ранее открытой папкой нажатием на&nbsp;<em>X</em>&nbsp;(крестик), то возникала ошибка "Cannot read property 'ActiveLoadersCount' of undefined" или "this.FFileSenderManager is undefined" (#8529).</p>

<p><a href="https://help.loginom.ru/userguide/processors/transformation/row-filter/" target="_blank"><strong>Фильтр строк:</strong></a>&nbsp;при повторном заходе в мастер фильтрации метка на плитке с фильтром по временному промежутку отображалась не полностью, если текст был длинный. Например, если было выбрано условие «первый день от текущей даты» (#8633).</p>

<p><strong>Фильтр строк:</strong>&nbsp;было невозможно настроить два и более условий по временному промежутку (<em>первый/не первый или последний/не последний</em>) (#8634).</p>

<p><a href="https://help.loginom.ru/userguide/processors/control/cycle.html" target="_blank"><strong>Цикл:</strong></a>&nbsp;при активации параллельного Цикла, содержащего вложенную Подмодель и Узел-ссылку, ссылающийся на узел, находящийся внутри Подмодели, могла возникать ошибка «Узел "Цикл" заблокирован». Чем больше итераций было выбрано в настройках Цикла, тем выше была вероятность возникновения ошибки (#8531).</p>

<p><strong>Экспорт в PostgreSQL:</strong>&nbsp;при попытке экспорта строк в поля&nbsp;<em>xml</em>&nbsp;или&nbsp;<em>json</em>&nbsp;возникала ошибка «колонка "..." имеет тип ..., а выражение - character varying». Если ранее возникала ошибка, то после обновления необходимо повторно пройти мастер настройки экспорта (#8585).</p>

<p><strong>Ядро платформы:</strong>&nbsp;в случае, если Подмодель содержала Узел-ссылку, ссылающийся на другой узел внутри этой подмодели, а порядок выполнения для Узла-ссылки был связан со входным и выходным портом содержащей его Подмодели, то процесс активации Подмодели мог зависнуть и его невозможно было отменить. Если Подмодель выполнялась в Цикле, то это повышало вероятность возникновения ошибки (#8514).</p>

<h2 id="повышение-информативности">UI/UX Improvements</h2>

<p><strong>Импорт из Deductor Warehouse:</strong>&nbsp;при попытке выполнить ненастроенный узел импорта возникала неинформативная ошибка. Теперь появляется предупреждение, что не выбран объект хранилища данных (#8515).</p>

<p><a href="https://help.loginom.ru/userguide/scenario/ports/" target="_blank"><strong>Настройка портов:</strong></a>&nbsp;сообщения об ошибках «Сокет не настроен» и «Не задана ссылка на сокет» заменены на более информативные сообщения «...: Порт ... не настроен» и «...: К обязательному порту ... не подключена связь» с указанием метки порта, в котором возникла ошибка (#6000).</p>

<h2 id="удобство-использования">Ease of Use</h2>

<p><a href="https://help.loginom.ru/userguide/processors/programming/python/" target="_blank"><strong>Python:</strong></a>&nbsp;функция&nbsp;<em>builtin_pandas_utils.to_data_frame</em>&nbsp;доработана таким образом, чтобы была возможность создания&nbsp;<em>pandas.DataFrame</em>&nbsp;по целочисленным и логическим столбцам, содержащим пропуски. Если при заполнении массивов&nbsp;<em>numpy</em>&nbsp;возникает необходимость обработки пропущенных значений целочисленного и логического типов, то используется вещественный тип, а пропущенные значения преобразуются в&nbsp;<em>NaN</em>&nbsp;(<em>np.nan</em>). Ранее при попытке передать в функцию&nbsp;<em>builtin_pandas_utils.to_data_frame</em>&nbsp;таблицу, содержащую целочисленный или логический столбец с пропущенными значениями, возникала ошибка "...int() argument must be a string, a bytes-like object or a number, not 'NoneType' " (#8522).</p>

<p><strong>Импорт из Deductor Warehouse:</strong>&nbsp;у выходных столбцов отключена автоматическая инициализация «Назначения по умолчанию» на основе типов объектов хранилища данных. Ранее для&nbsp;<em>Фактов</em>&nbsp;устанавливались «Назначения по умолчанию» равное&nbsp;<em>Показатель</em>, а для&nbsp;<em>Измерений</em>&nbsp;-&nbsp;<em>Группа</em>. У Пользователя есть возможность самостоятельно установить для выходных столбцов «Назначения по умолчанию». Прежнее поведение могло, в том числе, приводить к ошибкам в визуализаторе Куб&nbsp;<em>#5803</em>&nbsp;(#8506).</p>

<p><strong>Конечные классы:</strong>&nbsp;отключено отображение с округлением значений границ конечного класса в мастере настройки. Ранее при ручном редактировании границ, их значение отображалось с округлением до двух знаков после запятой (#8635).</p>

<p><strong>Логирование:</strong>&nbsp;в сообщения лога для событий начала и окончания выполнения узла добавлен GUID (уникальный идентификатор) узла (#8667).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;при выполнении функционала «Вырезать-Вставить» вместо копирования и удаления исходной папки теперь используется операция перемещения. Ранее операция «Вырезать-Вставить» могла занимать продолжительное время, а также при копировании каталогов с объемом больше 2 Гб можно было в процессе копирования на соседней вкладке вырезать подкаталог копируемого каталога (#6031, #6366).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;оптимизирована скорость создания каталогов для случая, когда в текущем каталоге уже содержится большое количество каталогов (несколько десятков или сотни вложенных каталогов) (#8196).</p>

<p><strong>Файловое хранилище:</strong>&nbsp;в корне файлового хранилища сделаны неактивными действия, которые невозможно было выполнить:&nbsp;<em>Загрузить, Создать каталог, Скачать, Переименовать, Копировать, Вставить, Вырезать, Удалить</em>&nbsp;(#8542).</p>

<p><strong>Ядро платформы:</strong>&nbsp;количество рабочих потоков сделано динамическим. Если процессор загружен меньше, чем на 80% и есть очередь процессов на выполнение, то количество рабочих потоков увеличивается, пока загрузка процессора не превысит 80%. Если дополнительные потоки простаивают, то они постепенно удаляются, чтобы снизить потребление оперативной памяти. Ранее, если на сервере было одновременно запущено большое количество сценариев, содержащих узлы, которые ожидают ответы от внешних приложений или сервисов (Выполнение программы, REST-запрос, импорт из Баз данных и тому подобные), то могла наблюдаться ситуация, когда процессор загружен значительно меньше 100%, но новые процессы не выполняются (#7255).</p>
